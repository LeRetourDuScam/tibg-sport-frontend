<div class="min-h-screen bg-[#fafafa]">
  <header class="bg-white border-b border-neutral-200 sticky top-0 z-40">
    <div class="max-w-2xl mx-auto px-4 py-3 flex items-center justify-between">
      <a [routerLink]="['/']" class="text-base font-semibold text-neutral-800 hover:text-neutral-600 cursor-pointer">FytAI</a>
      <div class="flex items-center gap-4 text-sm text-neutral-500">
        <span>{{ completionPercentage }}%</span>
        <span class="text-neutral-300">‚Ä¢</span>
        <span>~{{ remainingTime }} min</span>
      </div>
    </div>
    <div class="h-1 bg-neutral-100">
      <div class="h-1 bg-blue-600 transition-all duration-300" [style.width.%]="completionPercentage"></div>
    </div>
  </header>

  <div class="max-w-2xl mx-auto px-4 py-6">
    <div class="mb-6">
      <h1 class="text-xl font-semibold text-neutral-900 mb-1">
        {{ 'FORM.TITLE' | translate }}
      </h1>
      <p class="text-sm text-neutral-500">
        {{ 'FORM.SUBTITLE' | translate }}
      </p>
      <div *ngIf="lastSaved" class="text-xs text-neutral-400 mt-2">
        {{ 'FORM.AUTO_SAVED' | translate }}
      </div>
    </div>

    <div class="mb-6 hidden md:block">
      <div class="flex items-center">
        <div *ngFor="let step of [0, 1, 2, 3, 4]; let i = index" class="flex-1 flex items-center" [class.last:flex-grow-0]="i === 4">
          <button
            type="button"
            class="flex flex-col items-center shrink-0 cursor-pointer group"
            (click)="goToStep(i)"
            [disabled]="currentStep < i">
            <div
              class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors"
              [class.bg-blue-600]="currentStep === i"
              [class.text-white]="currentStep === i"
              [class.bg-green-600]="currentStep > i"
              [class.text-white]="currentStep > i"
              [class.bg-neutral-200]="currentStep < i"
              [class.text-neutral-500]="currentStep < i">
              <span *ngIf="currentStep <= i">{{ i + 1 }}</span>
              <svg *ngIf="currentStep > i" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <span class="mt-1.5 text-xs text-neutral-600 text-center" [class.font-medium]="currentStep === i">
              <ng-container [ngSwitch]="i">
                <ng-container *ngSwitchCase="0">{{ 'FORM.STEP_PERSONAL' | translate }}</ng-container>
                <ng-container *ngSwitchCase="1">{{ 'FORM.STEP_GOALS' | translate }}</ng-container>
                <ng-container *ngSwitchCase="2">{{ 'FORM.STEP_LIFESTYLE' | translate }}</ng-container>
                <ng-container *ngSwitchCase="3">{{ 'FORM.STEP_PREFERENCES' | translate }}</ng-container>
                <ng-container *ngSwitchCase="4">{{ 'FORM.STEP_COMMUNICATION' | translate }}</ng-container>
              </ng-container>
            </span>
          </button>
          <div *ngIf="i < 4" class="flex-1 h-px mx-2" [class.bg-green-600]="currentStep > i" [class.bg-neutral-200]="currentStep <= i"></div>
        </div>
      </div>
    </div>

    <div class="mb-6 md:hidden">
      <div class="flex items-center justify-center gap-1.5 mb-2">
        <div *ngFor="let step of [0, 1, 2, 3, 4]; let i = index"
             class="w-2 h-2 rounded-full transition-colors"
             [class.bg-blue-600]="currentStep === i"
             [class.bg-green-600]="currentStep > i"
             [class.bg-neutral-300]="currentStep < i">
        </div>
      </div>
      <div class="text-center">
        <p class="text-sm font-medium text-neutral-700">
          {{ 'FORM.STEP' | translate }} {{ currentStep + 1 }} / {{ totalSteps }}
        </p>
        <p class="text-xs text-neutral-500 mt-0.5">
          <ng-container [ngSwitch]="currentStep">
            <ng-container *ngSwitchCase="0">{{ 'FORM.STEP_PERSONAL' | translate }}</ng-container>
            <ng-container *ngSwitchCase="1">{{ 'FORM.STEP_GOALS' | translate }}</ng-container>
            <ng-container *ngSwitchCase="2">{{ 'FORM.STEP_LIFESTYLE' | translate }}</ng-container>
            <ng-container *ngSwitchCase="3">{{ 'FORM.STEP_PREFERENCES' | translate }}</ng-container>
            <ng-container *ngSwitchCase="4">{{ 'FORM.STEP_COMMUNICATION' | translate }}</ng-container>
          </ng-container>
        </p>
      </div>
    </div>

      <form class="space-y-6">

        <div *ngIf="currentStep === 0" [formGroup]="userAndHealthForm">
          <section class="bg-white border border-neutral-200 rounded-lg p-5 mb-5">
            <h2 class="text-base font-medium text-neutral-900 mb-4">
              {{ 'FORM.PERSONAL_INFO' | translate }}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm text-neutral-700 mb-1.5">{{ 'FORM.AGE' | translate }} *</label>
                <input
                  type="number"
                  formControlName="age"
                  class="w-full px-3 py-2 text-sm border border-neutral-300 rounded-md bg-white"
                  [class.border-red-400]="userAndHealthForm.get('age')?.invalid && userAndHealthForm.get('age')?.touched"
                  placeholder="Ex: 25">
                <span *ngIf="userAndHealthForm.get('age')?.invalid && userAndHealthForm.get('age')?.touched" class="text-red-500 text-xs mt-1 block">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-sm text-neutral-700 mb-1.5">{{ 'FORM.GENDER' | translate }} *</label>
                <select
                  formControlName="gender"
                  class="w-full px-3 py-2 text-sm border border-neutral-300 rounded-md bg-white">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="Gender.MALE">{{ 'FORM.MALE' | translate }}</option>
                  <option [value]="Gender.FEMALE">{{ 'FORM.FEMALE' | translate }}</option>
                  <option [value]="Gender.OTHER">{{ 'FORM.OTHER' | translate }}</option>
                </select>
                <span *ngIf="userAndHealthForm.get('gender')?.invalid && userAndHealthForm.get('gender')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
            </div>
          </section>

          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200 mb-6">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üìè</span> {{ 'FORM.PHYSICAL_MEASUREMENTS' | translate }}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.HEIGHT' | translate }} *</label>
                <input
                  type="number"
                  formControlName="height"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  placeholder="Ex: 175">
                  <span *ngIf="userAndHealthForm.get('height')?.invalid && userAndHealthForm.get('height')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.WEIGHT' | translate }} *</label>
                <input
                  type="number"
                  formControlName="weight"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  placeholder="Ex: 70">
                  <span *ngIf="userAndHealthForm.get('weight')?.invalid && userAndHealthForm.get('weight')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.LEG_LENGTH' | translate }} *</label>
                <input
                  type="number"
                  formControlName="legLength"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  placeholder="Ex: 90">
                  <span *ngIf="userAndHealthForm.get('legLength')?.invalid && userAndHealthForm.get('legLength')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.ARM_LENGTH' | translate }} *</label>
                <input
                  type="number"
                  formControlName="armLength"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  placeholder="Ex: 75">
                  <span *ngIf="userAndHealthForm.get('armLength')?.invalid && userAndHealthForm.get('armLength')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.WAIST_SIZE' | translate }} *</label>
                <input
                  type="number"
                  formControlName="waistSize"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  placeholder="Ex: 80">
                  <span *ngIf="userAndHealthForm.get('waistSize')?.invalid && userAndHealthForm.get('waistSize')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
            </div>
          </section>

          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200 mb-6">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üí™</span> {{ 'FORM.HEALTH_AND_FITNESS' | translate }}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.FITNESS_LEVEL' | translate }} *</label>
                <select
                  formControlName="fitnessLevel"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="FitnessLevel.SEDENTARY">{{ 'FORM.FITNESS_SEDENTARY' | translate }}</option>
                  <option [value]="FitnessLevel.LIGHT">{{ 'FORM.FITNESS_LIGHT' | translate }}</option>
                  <option [value]="FitnessLevel.MODERATE">{{ 'FORM.FITNESS_MODERATE' | translate }}</option>
                  <option [value]="FitnessLevel.INTENSE">{{ 'FORM.FITNESS_INTENSE' | translate }}</option>
                </select>
                <span *ngIf="userAndHealthForm.get('fitnessLevel')?.invalid && userAndHealthForm.get('fitnessLevel')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.EXERCISE_FREQUENCY' | translate }} *</label>
                <select
                  formControlName="exerciseFrequency"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="ExerciseFrequency.NEVER">{{ 'FORM.NEVER' | translate }}</option>
                  <option [value]="ExerciseFrequency.ONE_TO_TWO">{{ 'FORM.ONE_TO_TWO' | translate }}</option>
                  <option [value]="ExerciseFrequency.THREE_TO_FOUR">{{ 'FORM.THREE_TO_FOUR' | translate }}</option>
                  <option [value]="ExerciseFrequency.FIVE_PLUS">{{ 'FORM.FIVE_PLUS' | translate }}</option>
                </select>
                <span *ngIf="userAndHealthForm.get('exerciseFrequency')?.invalid && userAndHealthForm.get('exerciseFrequency')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
            </div>

            <div class="mt-4">
              <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.INJURIES' | translate }}</label>
              <textarea
                formControlName="injuries"
                rows="2"
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                [placeholder]="'FORM.INJURIES_PLACEHOLDER' | translate"></textarea>
            </div>

            <div class="mt-4">
              <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.ALLERGIES' | translate }}</label>
              <textarea
                formControlName="allergies"
                rows="2"
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                [placeholder]="'FORM.ALLERGIES_PLACEHOLDER' | translate"></textarea>
            </div>
          </section>

          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üè•</span> {{ 'FORM.HEALTH_CONDITIONS' | translate }}
            </h2>
            <div class="space-y-3">
              <label class="flex items-center space-x-3 cursor-pointer">
                <input type="checkbox" formControlName="jointProblems" class="w-5 h-5 text-slate-600">
                <span class="text-slate-700">{{ 'FORM.JOINT_PROBLEMS' | translate }}</span>
              </label>
              <label class="flex items-center space-x-3 cursor-pointer">
                <input type="checkbox" formControlName="kneeProblems" class="w-5 h-5 text-slate-600">
                <span class="text-slate-700">{{ 'FORM.KNEE_PROBLEMS' | translate }}</span>
              </label>
              <label class="flex items-center space-x-3 cursor-pointer">
                <input type="checkbox" formControlName="backProblems" class="w-5 h-5 text-slate-600">
                <span class="text-slate-700">{{ 'FORM.BACK_PROBLEMS' | translate }}</span>
              </label>
              <label class="flex items-center space-x-3 cursor-pointer">
                <input type="checkbox" formControlName="heartProblems" class="w-5 h-5 text-slate-600">
                <span class="text-slate-700">{{ 'FORM.HEART_PROBLEMS' | translate }}</span>
              </label>
              <div class="mt-4">
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.OTHER_HEALTH_ISSUES' | translate }}</label>
                <textarea
                  formControlName="otherHealthIssues"
                  rows="3"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.OTHER_HEALTH_PLACEHOLDER' | translate"></textarea>
              </div>
            </div>
          </section>
        </div>

        <div *ngIf="currentStep === 1" [formGroup]="goalAndMotivationForm">
          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üéØ</span> {{ 'FORM.GOALS_AND_MOTIVATIONS' | translate }}
            </h2>
            <div class="space-y-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.MAIN_GOAL' | translate }} *</label>
                <select
                  formControlName="mainGoal"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="MainGoal.LOSE_WEIGHT">{{ 'FORM.LOSE_WEIGHT' | translate }}</option>
                  <option [value]="MainGoal.GAIN_MUSCLE">{{ 'FORM.GAIN_MUSCLE' | translate }}</option>
                  <option [value]="MainGoal.ENDURANCE">{{ 'FORM.ENDURANCE' | translate }}</option>
                  <option [value]="MainGoal.FLEXIBILITY">{{ 'FORM.FLEXIBILITY' | translate }}</option>
                  <option [value]="MainGoal.GENERAL_HEALTH">{{ 'FORM.GENERAL_HEALTH' | translate }}</option>
                  <option [value]="MainGoal.COMPETITION">{{ 'FORM.COMPETITION' | translate }}</option>
                  <option [value]="MainGoal.LEISURE">{{ 'FORM.LEISURE' | translate }}</option>
                </select>
                <span *ngIf="goalAndMotivationForm.get('mainGoal')?.invalid && goalAndMotivationForm.get('mainGoal')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.SPECIFIC_GOALS' | translate }}</label>
                <textarea
                  formControlName="specificGoals"
                  rows="2"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.SPECIFIC_GOALS_PLACEHOLDER' | translate"></textarea>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.MOTIVATIONS' | translate }}</label>
                <textarea
                  formControlName="motivations"
                  rows="2"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.MOTIVATIONS_PLACEHOLDER' | translate"></textarea>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.FEARS' | translate }}</label>
                <textarea
                  formControlName="fears"
                  rows="2"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.FEARS_PLACEHOLDER' | translate"></textarea>
              </div>
            </div>
          </section>
        </div>

        <div *ngIf="currentStep === 2" [formGroup]="lifestyleAvailabilityForm">
          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">‚è∞</span> {{ 'FORM.LIFESTYLE_AND_AVAILABILITY' | translate }}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.AVAILABLE_TIME' | translate }} *</label>
                <select
                  formControlName="availableTime"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="AvailableTime.FIFTEEN_MIN">{{ 'FORM.FIFTEEN_MIN' | translate }}</option>
                  <option [value]="AvailableTime.THIRTY_MIN">{{ 'FORM.THIRTY_MIN' | translate }}</option>
                  <option [value]="AvailableTime.ONE_HOUR">{{ 'FORM.ONE_HOUR' | translate }}</option>
                  <option [value]="AvailableTime.ONE_HOUR_THIRTY">{{ 'FORM.ONE_HOUR_THIRTY' | translate }}</option>
                  <option [value]="AvailableTime.TWO_HOURS_PLUS">{{ 'FORM.TWO_HOURS_PLUS' | translate }}</option>
                </select>
                <span *ngIf="lifestyleAvailabilityForm.get('availableTime')?.invalid && lifestyleAvailabilityForm.get('availableTime')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.PREFERRED_TIME' | translate }} *</label>
                <select
                  formControlName="preferredTime"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="PreferredTime.MORNING">{{ 'FORM.MORNING' | translate }}</option>
                  <option [value]="PreferredTime.NOON">{{ 'FORM.NOON' | translate }}</option>
                  <option [value]="PreferredTime.EVENING">{{ 'FORM.EVENING' | translate }}</option>
                  <option [value]="PreferredTime.FLEXIBLE">{{ 'FORM.FLEXIBLE' | translate }}</option>
                </select>
                <span *ngIf="lifestyleAvailabilityForm.get('preferredTime')?.invalid && lifestyleAvailabilityForm.get('preferredTime')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.AVAILABLE_DAYS' | translate }}</label>
                <input
                  type="number"
                  formControlName="availableDays"
                  min="0"
                  max="7"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  placeholder="Ex: 3">
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.WORK_TYPE' | translate }} *</label>
                <select
                  formControlName="workType"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="WorkType.OFFICE_SEDENTARY">{{ 'FORM.OFFICE_SEDENTARY' | translate }}</option>
                  <option [value]="WorkType.PHYSICAL">{{ 'FORM.PHYSICAL' | translate }}</option>
                  <option [value]="WorkType.MIXED">{{ 'FORM.MIXED' | translate }}</option>
                </select>
                <span *ngIf="lifestyleAvailabilityForm.get('workType')?.invalid && lifestyleAvailabilityForm.get('workType')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.SLEEP_QUALITY' | translate }} *</label>
                <select
                  formControlName="sleepQuality"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="SleepQuality.BAD">{{ 'FORM.BAD' | translate }}</option>
                  <option [value]="SleepQuality.AVERAGE">{{ 'FORM.AVERAGE' | translate }}</option>
                  <option [value]="SleepQuality.GOOD">{{ 'FORM.GOOD' | translate }}</option>
                </select>
                <span *ngIf="lifestyleAvailabilityForm.get('sleepQuality')?.invalid && lifestyleAvailabilityForm.get('sleepQuality')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.STRESS_LEVEL' | translate }} *</label>
                <select
                  formControlName="stressLevel"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="StressLevel.LOW">{{ 'FORM.LOW' | translate }}</option>
                  <option [value]="StressLevel.MEDIUM">{{ 'FORM.MEDIUM' | translate }}</option>
                  <option [value]="StressLevel.HIGH">{{ 'FORM.HIGH' | translate }}</option>
                </select>
                <span *ngIf="lifestyleAvailabilityForm.get('stressLevel')?.invalid && lifestyleAvailabilityForm.get('stressLevel')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
            </div>
            <div class="mt-4">
              <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.LIFESTYLE' | translate }}</label>
              <input
                type="text"
                formControlName="lifestyle"
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                [placeholder]="'FORM.LIFESTYLE_PLACEHOLDER' | translate">
            </div>
          </section>
        </div>

        <div *ngIf="currentStep === 3" [formGroup]="trainingPreferencesForm">
          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200 mb-6">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">‚öôÔ∏è</span> {{ 'FORM.TRAINING_PREFERENCES' | translate }}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.LOCATION_PREFERENCE' | translate }} *</label>
                <select
                  formControlName="locationPreference"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="LocationPreference.HOME">{{ 'FORM.HOME' | translate }}</option>
                  <option [value]="LocationPreference.PARK">{{ 'FORM.PARK' | translate }}</option>
                  <option [value]="LocationPreference.GYM">{{ 'FORM.GYM' | translate }}</option>
                  <option [value]="LocationPreference.FLEXIBLE">{{ 'FORM.FLEXIBLE' | translate }}</option>
                </select>
                <span *ngIf="trainingPreferencesForm.get('locationPreference')?.invalid && trainingPreferencesForm.get('locationPreference')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.SOCIAL_PREFERENCE' | translate }} *</label>
                <select
                  formControlName="socialPreference"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="TeamPreference.ALONE">{{ 'FORM.ALONE' | translate }}</option>
                  <option [value]="TeamPreference.SMALL_GROUP">{{ 'FORM.SMALL_GROUP' | translate }}</option>
                  <option [value]="TeamPreference.LARGE_GROUP">{{ 'FORM.LARGE_GROUP' | translate }}</option>
                </select>
                <span *ngIf="trainingPreferencesForm.get('socialPreference')?.invalid && trainingPreferencesForm.get('socialPreference')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.MUSIC_PREFERENCE' | translate }} *</label>
                <select
                  formControlName="musicPreference"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="MusicPreference.YES">{{ 'FORM.YES' | translate }}</option>
                  <option [value]="MusicPreference.NO">{{ 'FORM.NO' | translate }}</option>
                  <option [value]="MusicPreference.DEPENDS">{{ 'FORM.DEPENDS' | translate }}</option>
                </select>
                <span *ngIf="trainingPreferencesForm.get('musicPreference')?.invalid && trainingPreferencesForm.get('musicPreference')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
            </div>
            <div class="mt-4">
              <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.EXERCISE_PREFERENCES' | translate }}</label>
              <textarea
                formControlName="exercisePreferences"
                rows="2"
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                [placeholder]="'FORM.EXERCISE_PREFERENCES_PLACEHOLDER' | translate"></textarea>
            </div>
            <div class="mt-4">
              <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.EXERCISE_AVERSIONS' | translate }}</label>
              <textarea
                formControlName="exerciseAversions"
                rows="2"
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                [placeholder]="'FORM.EXERCISE_AVERSIONS_PLACEHOLDER' | translate"></textarea>
            </div>
            <div class="mt-4">
              <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.EQUIPMENT_AVAILABLE' | translate }}</label>
              <textarea
                formControlName="equipmentAvailable"
                rows="2"
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                [placeholder]="'FORM.EQUIPMENT_AVAILABLE_PLACEHOLDER' | translate"></textarea>
            </div>
          </section>

          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200 mb-6">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üìö</span> {{ 'FORM.HISTORY_AND_EXPERIENCE' | translate }}
            </h2>
            <div class="space-y-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.PAST_EXPERIENCE' | translate }} *</label>
                <select
                  formControlName="pastExperienceWithFitness"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="ExperienceLevel.BEGINNER">{{ 'FORM.BEGINNER' | translate }}</option>
                  <option [value]="ExperienceLevel.INTERMEDIATE">{{ 'FORM.INTERMEDIATE' | translate }}</option>
                  <option [value]="ExperienceLevel.ADVANCED">{{ 'FORM.ADVANCED' | translate }}</option>
                </select>
                <span *ngIf="trainingPreferencesForm.get('pastExperienceWithFitness')?.invalid && trainingPreferencesForm.get('pastExperienceWithFitness')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.PRACTISED_SPORTS' | translate }}</label>
                <textarea
                  formControlName="practisedSports"
                  rows="2"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.PRACTISED_SPORTS_PLACEHOLDER' | translate"></textarea>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.FAVORITE_ACTIVITY' | translate }}</label>
                <input
                  type="text"
                  formControlName="favoriteActivity"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.FAVORITE_ACTIVITY_PLACEHOLDER' | translate">
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.SUCCESS_FACTORS' | translate }}</label>
                <textarea
                  formControlName="successFactors"
                  rows="2"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.SUCCESS_FACTORS_PLACEHOLDER' | translate"></textarea>
              </div>
            </div>
          </section>

          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üß†</span> {{ 'FORM.PERSONAL_CONTEXT' | translate }}
            </h2>
            <div class="space-y-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.PRIMARY_CHALLENGES' | translate }}</label>
                <textarea
                  formControlName="primaryChallenges"
                  rows="2"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.PRIMARY_CHALLENGES_PLACEHOLDER' | translate"></textarea>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.SUPPORT_SYSTEM' | translate }}</label>
                <input
                  type="text"
                  formControlName="supportSystem"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"
                  [placeholder]="'FORM.SUPPORT_SYSTEM_PLACEHOLDER' | translate">
              </div>
            </div>
          </section>
        </div>

        <div *ngIf="currentStep === 4" [formGroup]="communicationPreferencesForm">
          <section class="bg-slate-50 p-6 rounded-lg border border-slate-200">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4 flex items-center">
              <span class="mr-2">üí¨</span> {{ 'FORM.COMMUNICATION_PREFERENCES' | translate }}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.PREFERRED_TONE' | translate }} *</label>
                <select
                  formControlName="preferredTone"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="PreferredTone.MOTIVATING">{{ 'FORM.MOTIVATING' | translate }}</option>
                  <option [value]="PreferredTone.FACTUAL">{{ 'FORM.FACTUAL' | translate }}</option>
                  <option [value]="PreferredTone.PLAYFUL">{{ 'FORM.PLAYFUL' | translate }}</option>
                  <option [value]="PreferredTone.STRICT">{{ 'FORM.STRICT' | translate }}</option>
                </select>
                <span *ngIf="communicationPreferencesForm.get('preferredTone')?.invalid && communicationPreferencesForm.get('preferredTone')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
              <div>
                <label class="block text-slate-700 font-medium mb-2">{{ 'FORM.LEARNING_STYLE' | translate }} *</label>
                <select
                  formControlName="learningStyle"
                  class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent">
                  <option value="" disabled selected>{{ 'FORM.SELECT' | translate }}</option>
                  <option [value]="LearningStyle.VISUAL">{{ 'FORM.VISUAL' | translate }}</option>
                  <option [value]="LearningStyle.AUDITORY">{{ 'FORM.AUDITORY' | translate }}</option>
                  <option [value]="LearningStyle.KINESTHETIC">{{ 'FORM.KINESTHETIC' | translate }}</option>
                  <option [value]="LearningStyle.READING">{{ 'FORM.READING' | translate }}</option>
                </select>
                <span *ngIf="communicationPreferencesForm.get('learningStyle')?.invalid && communicationPreferencesForm.get('learningStyle')?.touched" class="text-red-500 text-sm">{{ 'FORM.REQUIRED_FIELD' | translate}}</span>
              </div>
            </div>
          </section>
        </div>

        <div class="flex justify-between items-center pt-4 border-t border-neutral-200 mt-6">
          <button
            *ngIf="currentStep > 0"
            type="button"
            (click)="previousStep()"
            class="inline-flex items-center gap-1 px-4 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-colors cursor-pointer">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
            <span class="hidden sm:inline">{{ 'FORM.PREVIOUS' | translate }}</span>
          </button>
          <div *ngIf="currentStep === 0"></div>

          <button
            *ngIf="currentStep < totalSteps - 1"
            type="button"
            (click)="nextStep()"
            class="inline-flex items-center gap-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors cursor-pointer ml-auto">
            <span class="hidden sm:inline">{{ 'FORM.NEXT' | translate }}</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
          </button>

          <button
            *ngIf="currentStep === totalSteps - 1"
            type="button"
            (click)="onSubmit()"
            [disabled]="isSubmitting"
            class="inline-flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ml-auto">
            <span *ngIf="!isSubmitting">{{ 'FORM.SUBMIT_BUTTON' | translate }}</span>
            <span *ngIf="isSubmitting" class="flex items-center gap-2">
              <svg class="animate-spin w-4 h-4" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
              {{ 'FORM.SUBMITTING' | translate }}
            </span>
          </button>
        </div>

        <p class="text-center mt-3 text-neutral-400 text-xs">
          {{ 'FORM.REQUIRED_FIELDS' | translate }}
        </p>
      </form>
    </div>

  <div *ngIf="snackbarVisible"
       class="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-4 py-3 rounded-md shadow-lg z-50 animate-fade-in text-sm">
    <div class="flex items-center gap-2">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
      <span>{{ snackbarMessage }}</span>
    </div>
  </div>
</div>
