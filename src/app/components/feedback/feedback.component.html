<div class="bg-white border border-neutral-200 rounded-lg p-5">
  <h3 class="text-base font-medium text-neutral-900 mb-3">
    {{ 'FEEDBACK.TITLE' | translate }}
  </h3>

  <div *ngIf="!isSubmitted" class="space-y-4">
    <div class="grid grid-cols-2 gap-3">
      <button
        *ngFor="let rating of ratings"
        (click)="selectRating(rating)"
        [class.ring-2]="selectedRating === rating"
        [class.ring-blue-500]="selectedRating === rating"
        [class.bg-blue-50]="selectedRating === rating"
        class="flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-all cursor-pointer">
        <lucide-icon [img]="getRatingIcon(rating)" [size]="20"></lucide-icon>
        <span>{{ getRatingLabel(rating) | translate }}</span>
      </button>
    </div>

    <div>
      <textarea
        [(ngModel)]="feedbackComment"
        rows="2"
        [placeholder]="'FEEDBACK.COMMENT_PLACEHOLDER' | translate"
        [class.border-red-500]="isCommentTooLong()"
        [class.border-neutral-300]="!isCommentTooLong()"
        [class.focus:ring-red-500]="isCommentTooLong()"
        [class.focus:ring-blue-500]="!isCommentTooLong()"
        class="w-full px-3 py-2 text-sm border rounded-md focus:outline-none focus:ring-2 resize-none">
      </textarea>
      <div class="flex items-center justify-between mt-1 text-xs">
        <span *ngIf="isCommentTooLong()" class="text-red-600 font-medium">
          {{ 'FEEDBACK.TOO_LONG' | translate }}
        </span>
        <span class="ml-auto" [class.text-red-600]="isCommentTooLong()" [class.text-neutral-500]="!isCommentTooLong()">
          {{ feedbackComment.length }} / 300
        </span>
      </div>
    </div>

    <button
      (click)="submitFeedback()"
      [disabled]="!selectedRating || isSubmitting || isCommentTooLong()"
      class="w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors cursor-pointer disabled:bg-blue-300 disabled:cursor-not-allowed">
      <span>{{ (isSubmitting ? 'FEEDBACK.SUBMITTING' : 'FEEDBACK.SUBMIT') | translate }}</span>
    </button>
  </div>

  <div *ngIf="isSubmitted" class="text-center py-8">
    <p class="text-base font-medium text-neutral-900">{{ 'FEEDBACK.THANK_YOU' | translate }}</p>
  </div>
</div>
